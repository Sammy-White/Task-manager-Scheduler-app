$(document).ready(function () { $("#sign_up").on("submit", function (e) { e.preventDefault(); let a = { name: $("#name").val(), email: $("#email").val(), password: $("#password").val() }; $.ajax({ type: "POST", url: "http://samson-task-manager.herokuapp.com/users", headers: { "Content-Type": "application/json" }, crossDomain: !0, cache: !1, data: JSON.stringify(a), success: function (e) { if (localStorage.setItem("token", e.token), a) return $(location).attr("href", "/profile") }, error: function (e) { if (e.responseJSON.errmsg) { let e = "invalid email address."; $("#email").next("span").text(e) } if (a.password.includes("password")) { let e = "such character not allowed."; $("#password").next("span").text(e) } }, beforeSend: function () { }, complete: function () { } }) }), $("#sign_in").on("submit", function (e) { e.preventDefault(); let a = { email: $("#sign_in_email").val(), password: $("#sign_in_pass").val() }; $.ajax({ type: "POST", url: "http://samson-task-manager.herokuapp.com/users/login", headers: { "Content-Type": "application/json" }, crossDomain: !0, cache: !1, data: JSON.stringify(a), success: function (e) { if (localStorage.setItem("token", e.token), a) return $(location).attr("href", "/profile") }, error: function (e) { if (e) { let e = "Invalid credentails."; $(".login_page").prev("span").text(e) } }, beforeSend: function () { }, complete: function () { } }) }), $.ajax({ type: "GET", url: "http://samson-task-manager.herokuapp.com/users/me", headers: { "Content-Type": "application/json", Authorization: localStorage.getItem("token") }, crossDomain: !0, cache: !1, success: function (e) { let a = e._id, o = "http://samson-task-manager.herokuapp.com/users/avatar/" + a, t = "", s = "", n = ""; n += "<form  id='forms'>", n += "<div class='form-row'>", n += "<div class='col-md-12 mb-3'>", n += "<label for='validationCustom01'>Full Name</label>", n += "<input id='name' type='text' class='form-control'  placeholder='Full Name'  value='" + e.name + "'>", n += "<span class='errorMessage'></span>", n += "</div>", n += "<div class='col-md-12 mb-3'>", n += "<label for='validationCustom02'>Email Address</label>", n += "<input id='email' type='email' class='form-control'   value=" + e.email + "  disabled>", n += "</div>", n += "<div class='col-md-12 mb-3'>", n += "<label for='validationCustom03'>Age</label>", n += "<input id='age' type='number' class='form-control'  placeholder='Age' value=" + e.age + ">", n += "<span class='errorMessage'></span>", n += "</div>", n += "<div class='col-md-12 mb-3'>", n += "<label for='validationCustom03'>New Password</label>", n += "<input id='pass1' type='password' class='form-control'  placeholder='Password'>", n += "<span class='errorMessage'></span>", n += "</div>", n += "<div class='col-md-12 mb-3'>", n += "<label for='validationCustom03'>Repeat-Password</label>", n += "<input id='pass2' type='password' class='form-control'  placeholder='Repeat-Password'>", n += "<span class='errorMessage'></span>", n += "</div>", n += "<button id='profile_save' class='btn btn-primary'>Save</button>", n += "</form>", s += " <p class='name'>" + e.name + "</p>", s += "<p class='role'>Manager</p>", t += "<img class='img-src' src=" + o + " alt=''>", $(".users-form").html(n), $(".profile_data").html(s), $(".profile_img").html(t) }, error: function (e) { } }), $("body").on("click", "#profile_save", function (e) { e.preventDefault(); let a = $("#pass1").val(); if (a != $("#pass2").val()) { let e = "password confirmation doesn't  match."; return $("#pass1").next("span").text(e), $("#pass2").next("span").text(e), $("#pass1").css("borderColor", "red"), void $("#pass2").css("borderColor", "red") } let o = $("#age").val(); if (o <= 11) { let e = "user age must be greater than 11"; return $("#age").next("span").text(e), void $("#age").css("borderColor", "red") } let t = $("#name").val(); if ("" === t || null === t) { let e = "user name cannot be empty!"; return $("#name").next("span").text(e), void $("#name").css("borderColor", "red") } let s = { name: t, age: o, password: a }; $.ajax({ type: "PATCH", url: "http://samson-task-manager.herokuapp.com/users/me", headers: { "Content-Type": "application/json", Authorization: localStorage.getItem("token") }, crossDomain: !0, cache: !1, data: JSON.stringify(s), success: function (e) { window.location.href = "/profile" }, error: function (e) { } }) }), $("#submit-upload").click(function (e) { e.preventDefault(); let a = new FormData; a.append("avatar", $("#myFile")[0].files[0]), $.ajax({ type: "POST", url: "http://samson-task-manager.herokuapp.com/users/me/avatar", headers: { Authorization: localStorage.getItem("token") }, crossDomain: !0, cache: !1, data: a, processData: !1, contentType: !1, success: function (e) { window.location.href = "/profile" }, error: function (e) { }, beforeSend: function () { }, complete: function () { } }) }), $("#delete-upload").click(function (e) { e.preventDefault(), $.ajax({ type: "DELETE", url: "http://samson-task-manager.herokuapp.com/users/me/avatar", headers: { Authorization: localStorage.getItem("token") }, crossDomain: !0, cache: !1, success: function (e) { window.location.href = "/profile" }, error: function (e) { }, beforeSend: function () { }, complete: function () { } }) }), $("#delete-profile").click(function (e) { e.preventDefault(), 1 == confirm("Are you sure you want to delete your account?\nIf you click OKss you will loose all saved data and your account will be permanently deleted!.\n") && $.ajax({ type: "DELETE", url: "http://samson-task-manager.herokuapp.com/users/me", headers: { Authorization: localStorage.getItem("token") }, crossDomain: !0, cache: !1, success: function (e) { window.location.href = "/" }, error: function (e) { }, beforeSend: function () { }, complete: function () { } }) }), $("#logout").click(function (e) { e.preventDefault(); let a = { sign_out: $("#logout") }; $.ajax({ type: "POST", url: "http://samson-task-manager.herokuapp.com/users/logout", headers: { "Content-Type": "application/json", Authorization: localStorage.getItem("token") }, crossDomain: !0, cache: !1, data: JSON.stringify(a), success: function (e) { if (a) return $(location).attr("href", "/login") }, error: function (e) { } }) }) });