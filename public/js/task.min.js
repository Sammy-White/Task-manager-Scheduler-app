$(document).ready(function(){$('#add-btn').click(function(event){event.preventDefault();let task={description:$('#title').val(),};if(task.description===""||task.description===null){let error='Field cannot be empty.';$('#title').next('span').text(error);return!1};$.ajax({type:'POST',url:'http://localhost:3000/tasks',headers:{'Content-Type':'application/json','Authorization':localStorage.getItem('token')},crossDomain:!0,cache:!1,data:JSON.stringify(task),success:function(data){console.log('Task Created Successfully!')
console.log(data)
window.location.href="/profile"},error:function(error){console.log(error)}})});getTask();function getTask(){$.ajax({type:'GET',url:'http://localhost:3000/tasks',headers:{'Content-Type':'application/json','Authorization':localStorage.getItem('token')},crossDomain:!0,cache:!1,success:function(data){console.log(data)
let view='';for(let i=0;i<data.length;i++){view+="<tr class='table-data'>";view+="<td class='title'>";view+=" <p id='task' data-id="+data[i]._id+" data-completed="+data[i].completed+"> "+data[i].description+" </p>";view+=" </td>";view+="<td class='icon'>";view+="<ul>";view+="<li id='delete' class='delete' data-id="+data[i]._id+" ><i class='far fa-trash-alt'></i></li>";view+="<li id='edit' class='edit' data-toggle='modal' data-target='#exampleModal' data-id="+data[i]._id+" data-description='"+data[i].description+"' data-completed="+data[i].completed+" ><i class='fas fa-pencil-alt'></i></li>";view+=" </ul>";view+="</td>";view+="</tr>"}
$('.table-body').append(view)},error:function(error){console.log(error)}});taskComplete()};$('body').on('click','#edit',function(e){e.preventDefault();let id=$(this).data('id');$('#editBtn').click(function(e){e.preventDefault();let task={description:$('#editForm').val(),completed:!1};if(task.description===""||task.description===null){let error='Field cannot be empty.';$('#editForm').next('span').text(error);return!1};$.ajax({type:'PATCH',url:'http://localhost:3000/tasks/'+id,headers:{'Content-Type':'application/json','Authorization':localStorage.getItem('token')},crossDomain:!0,cache:!1,data:JSON.stringify(task),success:function(data){console.log('Task Edited Successfully!')
console.log(data)
window.location.href="/profile"},error:function(error){console.log(error.responseJSON)}})})});function taskComplete(){$('body').on('click','#task',function(e){e.preventDefault()
$(this).toggleClass('stroked').css('color','red')
let id=$(this).data('id');let task={completed:!0,};$.ajax({type:'PATCH',url:'http://localhost:3000/tasks/'+id,headers:{'Content-Type':'application/json','Authorization':localStorage.getItem('token')},crossDomain:!0,cache:!1,data:JSON.stringify(task),success:function(data){console.log('Task Edited Successfully!')
console.log(data)},error:function(error){console.log(error.responseJSON)}})})};$('body').on('click','#delete',function(e){e.preventDefault();console.log($(this).data('id'))
let id=$(this).data('id');$.ajax({type:'DELETE',url:'http://localhost:3000/tasks/'+id,headers:{'Authorization':localStorage.getItem('token')},async:!0,timeout:300000,crossDomain:!0,cache:!1,success:function(data){console.log('Task has been Deleted!')
console.log(data)
window.location.href="/profile"},error:function(error){console.log(error)}})})})